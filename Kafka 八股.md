# Kafka 常见问题整理

1. Kafka 是什么？有什么作用？  
2. Kafka 的使用场景有哪些？  
3. Kafka 都有哪些特点？  
4. Kafka 架构是怎么样的？  
5. ISR、OSR、AR 是什么？  
6. Kafka 缺点？  
7. Kafka 如何做到消息的有序性？  
8. Kafka 的可靠性是怎么保证的？  
9. 发送消息的分区策略有哪些？  
10. Kafka 的 Rebalance（重平衡）是什么？  
11. 如何保证消息不被重复消费？  
12. Kafka 与 RocketMQ 区别？  
13. Kafka 的消息模型？  
14. Kafka 是如何保证高吞吐的？  
15. Kafka 如何保证消息不丢失？  
16. Kafka 的消息事务，消息交付语义？
17. 零拷贝是什么
这个有点乱，整理一下

### **零拷贝（Zero-copy）**

**零拷贝**是⼀种优化数据传输的技术，它的**核心思想**是减少数据在用户态和内核态之间不必要的拷贝次数，从而**提⾼系统性能和效率**。

---

### **背景**

假设应用要把一个文件发给客户端（`read → write`）：

1. **磁盘 → 内核缓冲区**（**DMA 拷贝**）
2. **内核缓冲区 → 用户缓冲区**（**CPU 拷贝**）
3. **用户缓冲区 → 套接字缓冲区**（**CPU 拷贝**）
4. **套接字缓冲区 → 网卡缓冲区**（**DMA 拷贝**）

👉 **这样一次完整流程需要 4 次拷贝（其中 2 次 DMA、2 次 CPU 拷贝）。CPU 的那两次拷贝完全是重复劳动，浪费性能。**
<img width="1880" height="1120" alt="PixPin_2025-08-15_16-21-32" src="https://github.com/user-attachments/assets/372c3fa0-5b15-4b1a-8c7e-ec75b4483ebe" />

---

### **实现方式**

1. **`mmap （memory map，内存映射`）**：
   
   - 把内核缓冲区通过**内存映射（mmap）**直接映射到用户空间，**避免了从内核缓冲区到⽤户缓冲区的拷⻉**。
2. **`sendfile`**：
   
   - `sendfile` 是 Linux 提供的⼀种**直接发送⽂件**的⽅法，能够直接把文件数据从**内核缓冲区发送到 socket 缓冲区**，**绕过用户态，减少一次拷贝**。
3. **`DMA`（Direct Memory Access，直接内存访问）**：
   
   - ⽂件数据通过 **DMA** 直接从**磁盘传输到⽹络设备**，**完全绕过 CPU 和内存**。




